import React, { useState } from "react";
import { useTodo } from "../contexts/todoContext.js";

function TodoTray({ todo }) {
  const [newTodo, setNewTodo] = useState(todo.todo);
  const [isTodoEditable, setIsTodoEditable] = useState(false);
  const { updateTodo, deleteTodo, toggleCompleted } = useTodo();

  const editTodo = () => {
    updateTodo(todo.id, { ...todo, todo: newTodo });
    setIsTodoEditable(false);
  };

  return (
    <div className="mt-2 flex justify-center bg-[rgb(0,0,0,0.6)] h-11 p-1 rounded-lg">
      <div className="flex items-center">
        <input
          className="w-6 h-5 text-pink-600 border-pink-300 rounded transform transition-transform duration-150 active:scale-90 focus:ring-pink-400"
          type="checkbox"
          checked={todo.isCompleted}
          onChange={() => toggleCompleted(todo.id)}
        />
        <input
          className=" h-9 px-2 outline-none text-amber-50 font-bold"
          type="text"
          readOnly={!isTodoEditable}
          value={newTodo}
          onChange={(e) => setNewTodo(e.target.value)}
        />
      </div>

      <div className="flex">
        <button
          className="bg-[rgb(90,202,70)] rounded-l-lg hover:bg-[rgb(90,202,70,0.6)]"
          onClick={() => {
            if (todo.isCompleted) return;
            isTodoEditable ? editTodo() : setIsTodoEditable((prev) => !prev);
          }}
        >
          {isTodoEditable ? (
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="40"
              height="22"
              viewBox="0 0 22 22"
              fill="none"
            >
              <path
                d="M6.20576 8.38751L11.1924 3.40084C11.2779 3.31537 11.3457 3.21391 11.3919 3.10224C11.4382 2.99057 11.462 2.87088 11.462 2.75001C11.462 2.62914 11.4382 2.50945 11.3919 2.39778C11.3457 2.28611 11.2779 2.18464 11.1924 2.09917C11.107 2.01371 11.0055 1.94591 10.8938 1.89965C10.7822 1.8534 10.6625 1.82959 10.5416 1.82959C10.2975 1.82959 10.0634 1.92656 9.89076 2.09917L5.55493 6.41667L3.85909 4.73917C3.68648 4.56656 3.45237 4.46959 3.20826 4.46959C2.96415 4.46959 2.73004 4.56656 2.55743 4.73917C2.38481 4.91179 2.28784 5.1459 2.28784 5.39001C2.28784 5.63412 2.38481 5.86823 2.55743 6.04084L4.90409 8.38751C4.98931 8.47342 5.09069 8.54162 5.2024 8.58816C5.3141 8.6347 5.43391 8.65866 5.55493 8.65866C5.67594 8.65866 5.79575 8.6347 5.90745 8.58816C6.01916 8.54162 6.12054 8.47342 6.20576 8.38751ZM16.9583 5.50001H11.9166C11.6735 5.50001 11.4403 5.59658 11.2684 5.76849C11.0965 5.9404 10.9999 6.17356 10.9999 6.41667C10.9999 6.65979 11.0965 6.89295 11.2684 7.06486C11.4403 7.23676 11.6735 7.33334 11.9166 7.33334H16.9583C17.2014 7.33334 17.4345 7.42992 17.6064 7.60183C17.7783 7.77373 17.8749 8.00689 17.8749 8.25001V17.16L16.4358 15.8308C16.2667 15.6726 16.044 15.5841 15.8124 15.5833H7.79159C7.54848 15.5833 7.31532 15.4868 7.14341 15.3149C6.9715 15.1429 6.87493 14.9098 6.87493 14.6667V11.4583C6.87493 11.2152 6.77835 10.9821 6.60644 10.8102C6.43453 10.6383 6.20137 10.5417 5.95826 10.5417C5.71514 10.5417 5.48199 10.6383 5.31008 10.8102C5.13817 10.9821 5.04159 11.2152 5.04159 11.4583V14.6667C5.04159 15.396 5.33132 16.0955 5.84705 16.6112C6.36277 17.1269 7.06225 17.4167 7.79159 17.4167H15.4549L18.2049 19.9192C18.374 20.0774 18.5967 20.1659 18.8283 20.1667C18.954 20.1653 19.0783 20.1404 19.1949 20.0933C19.3589 20.0218 19.4983 19.9038 19.5961 19.7539C19.6938 19.6041 19.7455 19.4289 19.7449 19.25V8.25001C19.745 7.88577 19.6726 7.52515 19.5321 7.18909C19.3917 6.85303 19.1858 6.54823 18.9265 6.29238C18.6673 6.03654 18.3598 5.83474 18.0219 5.69872C17.684 5.5627 17.3225 5.49515 16.9583 5.50001V5.50001Z"
                fill="black"
              />
            </svg>
          ) : (
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="40"
              height="22"
              viewBox="0 0 22 22"
              fill="none"
            >
              <path
                d="M16.9583 5.04168H13.2917C13.0486 5.04168 12.8154 5.13826 12.6435 5.31017C12.4716 5.48208 12.375 5.71523 12.375 5.95835C12.375 6.20146 12.4716 6.43462 12.6435 6.60653C12.8154 6.77844 13.0486 6.87501 13.2917 6.87501H16.9583C17.2015 6.87501 17.4346 6.97159 17.6065 7.1435C17.7784 7.31541 17.875 7.54857 17.875 7.79168V16.7017L16.4358 15.3725C16.2668 15.2142 16.0441 15.1258 15.8125 15.125H7.79168C7.54857 15.125 7.31541 15.0284 7.1435 14.8565C6.97159 14.6846 6.87501 14.4515 6.87501 14.2083V13.2917C6.87501 13.0486 6.77844 12.8154 6.60653 12.6435C6.43462 12.4716 6.20146 12.375 5.95835 12.375C5.71523 12.375 5.48208 12.4716 5.31017 12.6435C5.13826 12.8154 5.04168 13.0486 5.04168 13.2917V14.2083C5.04168 14.9377 5.33141 15.6372 5.84714 16.1529C6.36286 16.6686 7.06234 16.9583 7.79168 16.9583H15.455L18.205 19.4608C18.3741 19.6191 18.5968 19.7075 18.8283 19.7083C18.9541 19.707 19.0784 19.6821 19.195 19.635C19.359 19.5635 19.4984 19.4455 19.5962 19.2956C19.6939 19.1458 19.7456 18.9706 19.745 18.7917V7.79168C19.745 7.42744 19.6727 7.06682 19.5322 6.73076C19.3917 6.39471 19.1859 6.0899 18.9266 5.83406C18.6674 5.57821 18.3599 5.37642 18.022 5.24039C17.6841 5.10437 17.3226 5.03682 16.9583 5.04168V5.04168ZM8.32335 11.4583H10.5417C10.7848 11.4583 11.018 11.3618 11.1899 11.1899C11.3618 11.018 11.4583 10.7848 11.4583 10.5417V8.32335C11.459 8.20271 11.4359 8.08312 11.3903 7.97143C11.3447 7.85975 11.2775 7.75817 11.1925 7.67251L6.07751 2.55751C5.90577 2.38678 5.67344 2.29095 5.43126 2.29095C5.18909 2.29095 4.95676 2.38678 4.78501 2.55751L2.55751 4.78501C2.38678 4.95676 2.29095 5.18909 2.29095 5.43126C2.29095 5.67344 2.38678 5.90577 2.55751 6.07751L7.67251 11.1925C7.75817 11.2775 7.85975 11.3447 7.97143 11.3903C8.08312 11.4359 8.20271 11.459 8.32335 11.4583V11.4583ZM5.42668 4.50085L9.62501 8.69918V9.61585H8.70835L4.50085 5.42668L5.42668 4.50085Z"
                fill="black"
              />
            </svg>
          )}
        </button>

        <button
          className="bg-[rgb(202,70,70)] rounded-r-lg hover:bg-[rgb(202,70,70,0.6)]"
          onClick={() => deleteTodo(todo.id)}
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="40"
            height="22"
            viewBox="0 0 22 22"
            fill="none"
          >
            <path
              d="M12.2925 11L18.0675 5.23415C18.2401 5.06154 18.3371 4.82743 18.3371 4.58332C18.3371 4.33921 18.2401 4.1051 18.0675 3.93249C17.8949 3.75988 17.6608 3.6629 17.4167 3.6629C17.1726 3.6629 16.9385 3.75988 16.7659 3.93249L11 9.70749L5.23419 3.93249C5.06158 3.75988 4.82747 3.6629 4.58336 3.6629C4.33925 3.6629 4.10514 3.75988 3.93253 3.93249C3.75991 4.1051 3.66294 4.33921 3.66294 4.58332C3.66294 4.82743 3.75991 5.06154 3.93253 5.23415L9.70753 11L3.93253 16.7658C3.84661 16.851 3.77841 16.9524 3.73188 17.0641C3.68534 17.1758 3.66138 17.2956 3.66138 17.4167C3.66138 17.5377 3.68534 17.6575 3.73188 17.7692C3.77841 17.8809 3.84661 17.9823 3.93253 18.0675C4.01774 18.1534 4.11913 18.2216 4.23083 18.2681C4.34253 18.3147 4.46235 18.3386 4.58336 18.3386C4.70437 18.3386 4.82418 18.3147 4.93589 18.2681C5.04759 18.2216 5.14898 18.1534 5.23419 18.0675L11 12.2925L16.7659 18.0675C16.8511 18.1534 16.9525 18.2216 17.0642 18.2681C17.1759 18.3147 17.2957 18.3386 17.4167 18.3386C17.5377 18.3386 17.6575 18.3147 17.7692 18.2681C17.8809 18.2216 17.9823 18.1534 18.0675 18.0675C18.1534 17.9823 18.2216 17.8809 18.2682 17.7692C18.3147 17.6575 18.3387 17.5377 18.3387 17.4167C18.3387 17.2956 18.3147 17.1758 18.2682 17.0641C18.2216 16.9524 18.1534 16.851 18.0675 16.7658L12.2925 11Z"
              fill="black"
            />
          </svg>
        </button>
      </div>
    </div>
  );
}
export default TodoTray;
